# Chromium Extension Installer (CEI)

A command-line tool to install and uninstall Chrome extensions programmatically on Windows.

## ⚠️ IMPORTANT WARNINGS

1. **CLOSE YOUR BROWSER COMPLETELY** before running this tool
   - All browser windows and background processes must be closed
   - Check Task Manager to ensure no browser processes are running
   - Failure to do so may result in the changes not taking effect

2. **BACKUP YOUR BROWSER DATA** before first use
   - This tool modifies browser configuration files
   - Backup location: `%LOCALAPPDATA%\<BrowserName>\User Data\`
   - Consider backing up:
     - `Default/Preferences`
     - `Default/Secure Preferences`
     - All `Profile X` folders

3. **DISABLE CHROME SYNC temporarily** to avoid sync conflicts
   - Chrome may sync back old settings if sync is enabled
   - Re-enable after verifying the extension is working

## Features

- Install Chrome extensions from `.zip` files to multiple Chromium browsers
- Supports: Chrome, Edge, Brave, Opera, Vivaldi, Chromium
- Uninstall installed extensions
- Automatically updates browser profile preferences
- Handles multiple browser profiles
- Generates proper extension IDs and security signatures
- Preserves all existing browser settings and data
- Modular architecture with clean separation of concerns

## Installation

### Build from source

```bash
go build -o cei.exe ./cmd/cei/main.go
```

### Using Makefile

```bash
make build
```

## Usage

### Install an extension

```bash
cei -i path/to/extension.zip
```

This will:
1. Extract the extension from the zip file
2. Copy it to `%APPDATA%\BrowserExtensions\<ExtensionName>`
3. Generate the extension ID
4. Update all Chrome profiles' Preferences and Secure Preferences
5. Calculate and set proper HMAC-SHA256 signatures

### Uninstall an extension

```bash
cei -u
```

This will:
1. Remove extension files from `%APPDATA%\BrowserExtensions\NewEngine`
2. Clean up all Chrome profile preferences
3. Recalculate security signatures

## How it works

The tool performs the following operations:

1. **Extension ID Generation**: Creates a unique ID by hashing the extension path
2. **Key Extraction**: Reads Chrome's encryption key from `resources.pak`
3. **Profile Detection**: Finds all Chrome user profiles
4. **Preference Updates**: Modifies `Preferences` and `Secure Preferences` files
5. **Security Signatures**: Calculates HMAC-SHA256 signatures using the user's SID and encryption key

## Requirements

- Windows OS
- Google Chrome installed
- Administrator privileges may be required

## Technical Details

### Extension ID Algorithm

The extension ID is generated by:
1. Converting the extension path to UTF-16LE encoding
2. Calculating SHA-256 hash
3. Converting hash bytes to lowercase letters (a-p range)

### Security

The tool uses Chrome's internal security mechanisms:
- Reads encryption key from `resources.pak`
- Uses system SID for signature generation
- Calculates HMAC-SHA256 signatures for integrity verification
- Updates both regular and secure preference files

## Project Structure

```
├── cmd/
│   └── cei/          # Command-line interface
│       └── main.go   # Entry point
├── internal/
│   ├── chrome/       # Chrome-specific operations
│   │   ├── key.go            # Encryption key extraction
│   │   ├── preferences.go    # Profile preferences management
│   │   └── profiles.go       # Profile detection
│   ├── extension/    # Extension management
│   │   └── extension.go      # Install/uninstall logic
│   ├── system/       # System-level operations
│   │   └── windows.go        # Windows SID and volume serial
│   ├── types/        # Data structures
│   │   └── preferences.go    # Chrome preferences types
│   └── utils/        # Utility functions
│       ├── crypto.go         # Cryptographic operations
│       ├── file.go           # File operations
│       └── slice.go          # Slice utilities
```

## Limitations

- Windows only (uses Windows-specific paths and commands)
- Requires Chrome to be closed during installation
- Only supports local extension installation (not Chrome Web Store)

## License

See LICENSE file for details.
